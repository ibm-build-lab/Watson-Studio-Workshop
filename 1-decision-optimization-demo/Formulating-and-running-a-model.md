# Formulating Complex Models Using Modeling Assistant

In this tutorial, we dive deeper into the use of the Modeling Assistant, focusing on formulating more complex models. It's designed to provide an in-depth understanding of how to construct advanced models, employ constraints and objectives, and run scenarios to find optimal solutions.

## Key Objectives:

1. **Understanding Data Schema:** The first step to formulating any model is understanding your data. We will learn how to import data and recognize the schema generated by the Modeling Assistant.

2. **Setting Up Model Objectives:** We delve into how to define the goals of your model through setting up objectives.

3. **Creating Constraints:** Building complex models often involves implementing constraints. We'll go through how to set up necessary restrictions to guide the model's solution.

4. **Running Scenarios:** Once our model is set up, we'll run different scenarios to find the best possible outcomes.

5. **Visualizing the Solution:** Visualization aids in understanding the model's solutions. We will explore how to interpret results using various visualization tools.

6. **Generating Python Notebooks:** For further development and integration into other applications, we'll learn how to export our model into a Python notebook.

By the end of this tutorial, you'll have a solid foundation for creating complex models, defining clear objectives, implementing effective constraints, and understanding the results. This will enable you to utilize the Modeling Assistant to its full capacity, leading to better and more efficient problem solving.



## Prerequisites
- Access to IBM Cloud Pak for Data as a Service
- Access to the necessary data files (available in the DO-samples)


## Steps:

### 1. Obtain Data Files
- Download and extract all the DO-samples onto your machine.
- Open your project in IBM Cloud Pak for Data as a Service.
- Upload the `house_activity.csv`, `house_expertise.csv`, and `house_subcontractor.csv` data files into your project.

### 2. Create a Scenario
- Create a project. Select 'Create an empty project', enter a project name, and click 'Create'.
- On the 'Manage' tab of your project, select the 'Services and integrations' section and click 'Associate service'. Select an existing Machine Learning service instance (or create a new one) and click 'Associate service'.
- On the 'Assets' tab of your project, click 'New asset'.
- Select 'Decision Optimization experiment' in the 'Graphical builders' section.
- Enter a name for your new Decision Optimization experiment, choose a deployment space from the drop-down menu (or create one), and click 'Create'. 

### 3. Prepare Data
- The experiment UI opens displaying the 'Prepare data' view. Select the three house sample files and click 'Import'.
- Imported data files are now displayed as tables in the 'Prepare data' view.

### 4. Choose the Modeling Assistant
- Click 'Build model' in the sidebar. In the pop-up window, select 'Modeling Assistant'.

### 5. Define your decision domain
- In the 'Model' view, select the decision domain for your problem. In this case, select 'Scheduling'.
- After selecting your domain, a pop-up window appears for you to map your data to the scheduling concepts Tasks and Resources.
- Under 'TASKS', click 'Choose a task' and choose 'house_activity' from the drop-down list. Then under 'RESOURCES' click 'Choose a resource' and choose 'house_subcontractor'. 
- Click 'Continue'.

### 6. Define How Tasks Will Use Resources
- Choose among three options on how tasks will utilize resources: 
    - Use resources with assignment (default): This option assigns specific subcontractors to activities to optimize the sequence of house construction activities.
    - Use resources without assignment: This option considers the number and types of subcontractors available but does not assign specific subcontractors to activities.
    - Continue without resources: This option creates a schedule of activities without considering any resource limits.
- For this example, use the default setting ('Use the resources... While assigning...') and click 'Continue'.

### 7. Review Your Model Formulation
- The Modeling Assistant provides a partially completed formulation in the model view.
- The model consists of an objective to be attained and some constraints that must be satisfied.
- These scheduling constraints ensure that: 
    - The scheduling will be performed from the start time defined for the construction project.
    - Each subcontractor can only be assigned to one task at a time.
    - Each activity has one subcontractor assigned to it.
    - All activities are present in the schedule.
    - The duration time for each activity is respected.

### 8. Save Your Work
- In the model view of your scenario, save a copy of your work by duplicating the scenario.
- If you click the 'Replace' icon next to 'Modeling Assistant', you can choose whether you want to create your model in Python or OPL, with the Modeling Assistant or in a Python notebook or import an existing model. Remember, if you choose to replace your model at this stage, you will overwrite your current model and lose your changes.


### 9. Duplicate the Scenario
- Open the 'Scenarios' panel, click the three dots next to 'Scenario 1', and select 'Duplicate'. 
- Name the new scenario, e.g., 'Scenario 2', and click 'Create'.

### 10. Complete your Model
- Define a duration for each activity and a 'Schedule start' in your constraints.
- Enter values to complete the constraints that are highlighted.
- Consider adding the precedence constraint to ensure that there are no time lags between activities.

### 11. Run your Model
- Set the solve time limit for your model in the 'Build model' view under the 'Settings' tab.
- Click 'Run' to find a solution that will provide the best optimal schedule based on your model objectives and constraints.

### 12. View your Solution
- Check the results in the 'Explore solution' view. You can download the solution tables as CSV files.
- Visualize the solution as a Gantt chart under the 'Visualization' view.

### 13. Create a New Scenario 
- Create a new scenario to analyze and compare different models and data.
- To add the precedence constraint to your model, duplicate 'Scenario 2' and name it 'Scenario 3'.
- Type 'activity after preceding activities' in the suggestions pane in the model view and add the corresponding constraint to your model.
- Run the model for 'Scenario 3' and compare the new solution with the solution obtained in 'Scenario 2'.
- For a more complex model, duplicate 'Scenario 3' and name it 'Scenario 4'. Add objectives and constraints to maximize subcontractors' skill levels and to ensure that subcontractors only undertake tasks they are permitted to do.
- Run the model for 'Scenario 4' and compare the new solution with the previous ones.

### 14. Model View Tips
- Use the 'Suggestions' filter to find specific objectives and constraints.
- Under the 'Settings' tab, specify a customized date/time format to suit your data.
- Use the 'Data Schema' tab to list all necessary information imported and deduced from the input data for the scheduling problem.
- Make the 'Decisions' tab visible to see the decision defined in your model and to add custom decisions.

### 15. Generate a Python Notebook from your Scenario
- Open the 'Scenarios' panel, click the three dots next to a scenario and select 'Generate notebook'.
- Name the notebook and click 'Generate'. A Python notebook for this model is created in your Project.

### 16. Overview Pane
- The 'Overview' pane provides summary information for all your scenarios. 
- Use this pane to duplicate, rename, generate a Python notebook, export a scenario, or save it for deployment.

### 17. Visualization View
- Use the 'Visualization' view to customize the display of any scenario, including input data, solution, and notes.
- Customize the layout using table widgets and chart widgets. 
- Add headers, change background colors, and adjust other properties of your notes, tables, or charts.
- Click on the pencil icon to change the content and format of an object, either using the graphical editor or by editing the JSON file.
- Use this view to visually compare scenarios.

The 'Visualization' view, 'Overview' pane, and the ability to generate a Python notebook provide useful ways to analyze, modify, and share your model and its scenarios. You can further customize and analyze your scenarios, visualize your solutions, and even export your model to Python for further development or integration into other applications.


more detailed document available [here](https://dataplatform.cloud.ibm.com/docs/content/DO/DODS_Mdl_Assist/exhousebuild.html?audience=wdp)